CREATE TABLE DEMO.PRODUCT_SUMMARY (
    product_id STRING,
    sale_count BIGINT,
    total_revenue DECIMAL(18,2),
    last_updated TIMESTAMP
)
USING DELTA
TBLPROPERTIES (
  'delta.feature.catalogOwned-preview' = 'supported', 
  'delta.feature.allowColumnDefaults' = 'supported'
);

-- Sample data for PRODUCT_SUMMARY table (matching product_ids from PRODUCT_DETAILS)
INSERT INTO DEMO.PRODUCT_SUMMARY VALUES
('P001', 1250, 1875000.00, '2024-12-01 10:30:00'),
('P002', 980, 1176000.00, '2024-12-01 11:15:00'),
('P003', 750, 2250000.00, '2024-12-01 09:45:00'),
('P004', 2100, 315000.00, '2024-12-01 14:20:00'),
('P005', 1800, 270000.00, '2024-12-01 13:10:00'),
('P006', 3200, 48000.00, '2024-12-01 16:30:00'),
('P007', 1500, 30000.00, '2024-12-01 15:45:00'),
('P008', 2800, 420000.00, '2024-12-01 12:00:00'),
('P009', 1200, 180000.00, '2024-12-01 11:30:00'),
('P010', 450, 135000.00, '2024-12-01 08:15:00'),
('P011', 380, 190000.00, '2024-12-01 07:45:00'),
('P012', 2200, 110000.00, '2024-12-01 17:20:00'),
('P013', 1800, 270000.00, '2024-12-01 18:00:00'),
('P014', 3200, 128000.00, '2024-12-01 19:30:00'),
('P015', 150, 45000.00, '2024-12-01 20:15:00');