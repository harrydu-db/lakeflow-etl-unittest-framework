CREATE TABLE DEMO.SALES_FACT (
    sale_id STRING,
    product_id STRING,
    sale_date DATE,
    quantity BIGINT,
    unit_price DECIMAL(18,2),
    total_amount DECIMAL(18,2),
    region_id STRING,
    channel_id STRING
)
USING DELTA
TBLPROPERTIES (
  'delta.feature.catalogOwned-preview' = 'supported', 
  'delta.feature.allowColumnDefaults' = 'supported'
);

-- Sample data for SALES_FACT table (with proper foreign key relationships)
INSERT INTO DEMO.SALES_FACT VALUES
('S001', 'P001', '2024-11-01', 2, 1500.00, 3000.00, 'NA', 'ONLINE'),
('S002', 'P001', '2024-11-02', 1, 1500.00, 1500.00, 'EU', 'RETAIL'),
('S003', 'P002', '2024-11-01', 3, 1200.00, 3600.00, 'AP', 'MOBILE'),
('S004', 'P003', '2024-11-03', 1, 3000.00, 3000.00, 'NA', 'ONLINE'),
('S005', 'P004', '2024-11-01', 5, 150.00, 750.00, 'LA', 'RETAIL'),
('S006', 'P004', '2024-11-04', 2, 150.00, 300.00, 'NA', 'ONLINE'),
('S007', 'P005', '2024-11-02', 4, 150.00, 600.00, 'EU', 'WHOLESALE'),
('S008', 'P006', '2024-11-01', 10, 15.00, 150.00, 'AP', 'ONLINE'),
('S009', 'P006', '2024-11-05', 8, 15.00, 120.00, 'NA', 'RETAIL'),
('S010', 'P007', '2024-11-03', 6, 20.00, 120.00, 'EU', 'ONLINE'),
('S011', 'P008', '2024-11-02', 3, 150.00, 450.00, 'LA', 'RETAIL'),
('S012', 'P008', '2024-11-04', 2, 150.00, 300.00, 'NA', 'ONLINE'),
('S013', 'P009', '2024-11-01', 1, 150.00, 150.00, 'EU', 'CALL'),
('S014', 'P010', '2024-11-03', 1, 300.00, 300.00, 'AP', 'ONLINE'),
('S015', 'P011', '2024-11-02', 1, 500.00, 500.00, 'NA', 'RETAIL'),
('S016', 'P012', '2024-11-01', 4, 50.00, 200.00, 'LA', 'ONLINE'),
('S017', 'P012', '2024-11-05', 3, 50.00, 150.00, 'EU', 'RETAIL'),
('S018', 'P013', '2024-11-02', 2, 150.00, 300.00, 'AP', 'MOBILE'),
('S019', 'P014', '2024-11-03', 8, 40.00, 320.00, 'NA', 'ONLINE'),
('S020', 'P015', '2024-11-01', 1, 300.00, 300.00, 'EU', 'PARTNER'),
('S021', 'P001', '2024-11-06', 1, 1500.00, 1500.00, 'AP', 'ONLINE'),
('S022', 'P002', '2024-11-06', 2, 1200.00, 2400.00, 'NA', 'RETAIL'),
('S023', 'P003', '2024-11-07', 1, 3000.00, 3000.00, 'EU', 'ONLINE'),
('S024', 'P004', '2024-11-08', 3, 150.00, 450.00, 'LA', 'MOBILE'),
('S025', 'P005', '2024-11-09', 2, 150.00, 300.00, 'AP', 'WHOLESALE'),
('S026', 'P006', '2024-11-10', 5, 15.00, 75.00, 'NA', 'ONLINE'),
('S027', 'P007', '2024-11-11', 3, 20.00, 60.00, 'EU', 'RETAIL'),
('S028', 'P008', '2024-11-12', 1, 150.00, 150.00, 'LA', 'ONLINE'),
('S029', 'P009', '2024-11-13', 2, 150.00, 300.00, 'AP', 'CALL'),
('S030', 'P010', '2024-11-14', 1, 300.00, 300.00, 'NA', 'RETAIL');