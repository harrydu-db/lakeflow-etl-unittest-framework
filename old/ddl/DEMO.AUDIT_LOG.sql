CREATE TABLE DEMO.AUDIT_LOG (
    process_name STRING,
    table_name STRING,
    record_count BIGINT,
    process_date DATE,
    status STRING
)
USING DELTA
TBLPROPERTIES (
  'delta.feature.catalogOwned-preview' = 'supported', 
  'delta.feature.allowColumnDefaults' = 'supported'
);

-- Sample data for AUDIT_LOG table
INSERT INTO DEMO.AUDIT_LOG VALUES
('DAILY_SALES_LOAD', 'SALES_FACT', 30, '2024-11-30', 'SUCCESS'),
('PRODUCT_SYNC', 'PRODUCT_DETAILS', 15, '2024-11-30', 'SUCCESS'),
('PRODUCT_AGGREGATION', 'PRODUCT_SUMMARY', 15, '2024-11-30', 'SUCCESS'),
('SALES_REPORTING_ETL', 'SALES_REPORTING', 28, '2024-11-30', 'SUCCESS'),
('MASTER_DATA_LOAD', 'CATEGORY', 8, '2024-11-29', 'SUCCESS'),
('MASTER_DATA_LOAD', 'REGION', 6, '2024-11-29', 'SUCCESS'),
('MASTER_DATA_LOAD', 'SALES_CHANNEL', 6, '2024-11-29', 'SUCCESS'),
('DAILY_SALES_LOAD', 'SALES_FACT', 25, '2024-11-29', 'SUCCESS'),
('PRODUCT_SYNC', 'PRODUCT_DETAILS', 12, '2024-11-29', 'SUCCESS'),
('SALES_REPORTING_ETL', 'SALES_REPORTING', 22, '2024-11-29', 'SUCCESS'),
('DAILY_SALES_LOAD', 'SALES_FACT', 28, '2024-11-28', 'SUCCESS'),
('PRODUCT_SYNC', 'PRODUCT_DETAILS', 10, '2024-11-28', 'SUCCESS'),
('SALES_REPORTING_ETL', 'SALES_REPORTING', 25, '2024-11-28', 'SUCCESS'),
('PRODUCT_AGGREGATION', 'PRODUCT_SUMMARY', 10, '2024-11-28', 'SUCCESS'),
('DAILY_SALES_LOAD', 'SALES_FACT', 32, '2024-11-27', 'SUCCESS'),
('PRODUCT_SYNC', 'PRODUCT_DETAILS', 8, '2024-11-27', 'SUCCESS'),
('SALES_REPORTING_ETL', 'SALES_REPORTING', 30, '2024-11-27', 'SUCCESS'),
('PRODUCT_AGGREGATION', 'PRODUCT_SUMMARY', 8, '2024-11-27', 'SUCCESS'),
('DAILY_SALES_LOAD', 'SALES_FACT', 0, '2024-11-26', 'FAILED'),
('PRODUCT_SYNC', 'PRODUCT_DETAILS', 5, '2024-11-26', 'SUCCESS'),
('SALES_REPORTING_ETL', 'SALES_REPORTING', 0, '2024-11-26', 'FAILED'),
('PRODUCT_AGGREGATION', 'PRODUCT_SUMMARY', 5, '2024-11-26', 'SUCCESS'),
('DAILY_SALES_LOAD', 'SALES_FACT', 35, '2024-11-25', 'SUCCESS'),
('PRODUCT_SYNC', 'PRODUCT_DETAILS', 18, '2024-11-25', 'SUCCESS'),
('SALES_REPORTING_ETL', 'SALES_REPORTING', 32, '2024-11-25', 'SUCCESS'),
('PRODUCT_AGGREGATION', 'PRODUCT_SUMMARY', 18, '2024-11-25', 'SUCCESS');